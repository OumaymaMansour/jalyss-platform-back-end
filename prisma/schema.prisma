generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Employee {
  id           Int     @id @default(autoincrement())
  first_name   String?
  last_name    String?
  email        String?
  phone_number String?
  address      String?
  position     String?
}

model Client {
  id                  Int       @id @default(autoincrement())
  fullName            String?
  phone_number        String?
  address             String?
  email               String?
  registration_date   DateTime?
  id_categorie_client Int?

  categorie_client CategorieClient? @relation(fields: [id_categorie_client], references: [id])
  BonCommande      BonCommande[]
  VenteFacture     VenteFacture[]
  BonRetour        BonRetour[]
  Devis            Devis[]
  BonSortie        BonSortie[]
}

model Article {
  id                   Int     @id @default(autoincrement())
  title                String?
  price                Float?
  quantity             Int?
  id_categorie_article Int?
  id_publishing_houses Int?

  categorie_article CategorieArticle?  @relation(fields: [id_categorie_article], references: [id])
  publishing_houses PublishingHouses?  @relation(fields: [id_publishing_houses], references: [id])
  CommandeLine      CommandeLine[]
  ArticleRetour     ArticleRetour[]
  BRLine            BRLine[]
  BLLine            BLLine[]
  BLFLine           BLFLine[]
  AchatFactureLine  AchatFactureLine[]
  DevisLine         DevisLine[]
  FactureLine       FactureLine[]
}

model PublishingHouses {
  id           Int       @id @default(autoincrement())
  name         String?
  address      String?
  phone_number String?
  email        String?
  Article      Article[]
}

model CategorieArticle {
  id      Int       @id @default(autoincrement())
  name    String?
  Article Article[]
}

model CategorieClient {
  id     Int      @id @default(autoincrement())
  name   String?
  Client Client[]
}

model AchatBonLivraison {
  id               Int       @id @default(autoincrement())
  id_bon_reception Int?
  delivery_date    DateTime?

  bon_reception BonReception? @relation(fields: [id_bon_reception], references: [id])
  BLLine        BLLine[]
}

model BonCommande {
  id                Int       @id @default(autoincrement())
  id_client         Int?
  id_bondesorti     Int?
  id_canaux_de_vent Int?
  order_date        DateTime?
  date              DateTime?

  client         Client?        @relation(fields: [id_client], references: [id])
  bon_sortie     BonSortie?     @relation(fields: [bonSortieId], references: [id])
  canaux_de_vent CanauxDeVent?  @relation(fields: [id_canaux_de_vent], references: [id])
  VenteFacture   VenteFacture[]
  CommandeLine   CommandeLine[]
  bonSortieId    Int?
}

model CanauxDeVent {
  id       Int     @id @default(autoincrement())
  nom      String?
  type     String?
  region   String?
  id_stock Int?

  stock       Stock?        @relation(fields: [id_stock], references: [id])
  BonCommande BonCommande[]
}

model VenteFacture {
  id              Int       @id @default(autoincrement())
  id_client       Int?
  id_bon_commande Int?
  id_bondesorti   Int?
  date            DateTime?

  client       Client?      @relation(fields: [id_client], references: [id])
  bon_commande BonCommande? @relation(fields: [id_bon_commande], references: [id])
  bon_sortie   BonSortie?   @relation(fields: [bonSortieId], references: [id])
  bonSortieId  Int?
}

model BonRetour {
  id          Int       @id @default(autoincrement())
  id_client   Int?
  return_date DateTime?

  client        Client?         @relation(fields: [id_client], references: [id])
  BonReception  BonReception[]
  ArticleRetour ArticleRetour[]
}

model Devis {
  id            Int       @id @default(autoincrement())
  id_facture    Int?
  id_client     Int?
  total_amount  Float?
  creation_date DateTime?
  date          DateTime?

  client    Client?     @relation(fields: [id_client], references: [id])
  DevisLine DevisLine[]
  BonSortie BonSortie[]
}

model BonReception {
  id             Int       @id @default(autoincrement())
  id_fournisseur Int?
  id_stock       Int?
  id_bon_retour  Int?
  type_reception String    @default("retour") // Enum with values "retour" or "achat"
  reception_date DateTime?

  fournisseur       Fournisseur?        @relation(fields: [id_fournisseur], references: [id])
  stock             Stock?              @relation(fields: [id_stock], references: [id])
  bon_retour        BonRetour?          @relation(fields: [id_bon_retour], references: [id])
  AchatBonLivraison AchatBonLivraison[]
  BonTransfer       BonTransfer[]
  AchatBLFacture    AchatBLFacture[]
  AchatFacture      AchatFacture[]
  BRLine            BRLine[]
}

model CommandeLine {
  id Int @id @default(autoincrement())

  id_article      Int?
  id_bon_commande Int?

  article      Article?     @relation(fields: [id_article], references: [id])
  bon_commande BonCommande? @relation(fields: [id_bon_commande], references: [id])
}

model ArticleRetour {
  id Int @id @default(autoincrement())

  id_article    Int?
  id_bon_retour Int?

  article    Article?   @relation(fields: [id_article], references: [id])
  bon_retour BonRetour? @relation(fields: [id_bon_retour], references: [id])
}

model Fournisseur {
  id                 Int            @id @default(autoincrement())
  nom_fournisseur    String
  phone_number       String?
  email              String?
  adresse            String?
  registrationNumber String?
  BonReception       BonReception[]
}

model BonTransfer {
  id               Int       @id @default(autoincrement())
  from             Int?
  to               Int?
  date             DateTime?
  id_bon_reception Int?
  id_bondesorti    Int?

  stock_from    Stock?        @relation(name: "StockFrom", fields: [from], references: [id])
  stock_to      Stock?        @relation(name: "StockTo", fields: [to], references: [id])
  bon_reception BonReception? @relation(fields: [id_bon_reception], references: [id])
  bon_sortie    BonSortie?    @relation(fields: [id_bondesorti], references: [id])
}

model AchatBLFacture {
  id               Int       @id @default(autoincrement())
  id_bon_reception Int?
  delivery_date    DateTime?

  bon_reception BonReception? @relation(fields: [id_bon_reception], references: [id])
  BLFLine       BLFLine[]
}

model Stock {
  id       Int     @id @default(autoincrement())
  location String?
  capacity Int?

  bon_transfer_from BonTransfer[]  @relation("StockFrom")
  bon_transfer_to   BonTransfer[]  @relation("StockTo")
  CanauxDeVent      CanauxDeVent[]
  BonReception      BonReception[]
}

model AchatFacture {
  id               Int       @id @default(autoincrement())
  id_bon_reception Int?
  delivery_date    DateTime?
  date             DateTime?

  bon_reception    BonReception?      @relation(fields: [id_bon_reception], references: [id])
  AchatFactureLine AchatFactureLine[]
  FactureLine      FactureLine[]
}

model BRLine {
  id Int @id @default(autoincrement())

  id_bon_reception Int?
  id_article       Int?

  bon_reception BonReception? @relation(fields: [id_bon_reception], references: [id])
  article       Article?      @relation(fields: [id_article], references: [id])
}

model BLLine {
  id Int @id @default(autoincrement())

  id_bon_livraison Int?
  id_article       Int?

  bon_livraison AchatBonLivraison? @relation(fields: [id_bon_livraison], references: [id])
  article       Article?           @relation(fields: [id_article], references: [id])
}

model BLFLine {
  id Int @id @default(autoincrement())

  id_bl_facture Int?
  id_article    Int?

  bl_facture AchatBLFacture? @relation(fields: [id_bl_facture], references: [id])
  article    Article?        @relation(fields: [id_article], references: [id])
}

model AchatFactureLine {
  id Int @id @default(autoincrement())

  id_achat_facture Int?
  id_article       Int?

  achat_facture AchatFacture? @relation(fields: [id_achat_facture], references: [id])
  article       Article?      @relation(fields: [id_article], references: [id])
}

model DevisLine {
  id Int @id @default(autoincrement())

  id_devis   Int?
  id_article Int?

  devis   Devis?   @relation(fields: [id_devis], references: [id])
  article Article? @relation(fields: [id_article], references: [id])
}

model FactureLine {
  id Int @id @default(autoincrement())

  id_facture Int?
  id_article Int?

  facture AchatFacture? @relation(fields: [id_facture], references: [id])
  article Article?      @relation(fields: [id_article], references: [id])
}

model BonSortie {
  id               Int       @id @default(autoincrement())
  id_bon_commande  Int?
  id_client        Int?
  id_vente_facture Int?
  id_devis         Int?
  type_reception   String    @default("retour") // Enum with values "retour" or "achat"
  sortie_date      DateTime?

  bon_commande  BonCommande[]
  client        Client?        @relation(fields: [id_client], references: [id])
  vente_facture VenteFacture[]
  devis         Devis?         @relation(fields: [id_devis], references: [id])
  BonTransfer   BonTransfer[]
}
